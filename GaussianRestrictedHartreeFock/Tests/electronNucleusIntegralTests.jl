using Cubature


const p =	[0 0 0 1.0 0.0 -1.5  1.2;
		   	 1 0 0 1.1 0.1 -1.2  2.5;
		   	 0 1 0 0.3 0.2 -1.0 -0.3;
		   	 0 0 1 0.9 0.3 -0.8  0.1;
		   	 0 0 2 2.2 0.4 -0.6 -3.1;
		   	 0 2 0 2.4 0.5 -0.4  3.8;
		   	 2 0 0 3.1 0.6 -0.2  1.3;
		   	 1 1 0 3.7 0.7  0.0  2.4;
		   	 0 1 1 1.3 0.8  0.2  5.3;
		   	 1 0 1 4.3 0.9  0.4  1.2]


function G( i ::Int, 	j ::Int, 	k ::Int, 	a::Number, 
			Ax::Number, Ay::Number, Az::Number, 
			x ::Number, y ::Number, z ::Number)
	rAx = x-Ax
	rAy = y-Ay
	rAz = z-Az
	rA2 = rAx^2 + rAy^2 + rAz^2
	return rAx^i * rAy^j * rAz^k * exp(-a * rA2)
end

function Gp( i1 ::Int, 		j1 ::Int, 		k1 ::Int, 		a1::Number, 
			 Ax1::Number, 	Ay1::Number, 	Az1::Number, 
			 i2 ::Int, 		j2 ::Int, 		k2 ::Int, 		a2::Number, 
			 Ax2::Number, 	Ay2::Number, 	Az2::Number,
			 x  ::Number, 	y  ::Number, 	z  ::Number,
			 nx ::Number, 	ny ::Number, 	nz ::Number)
	rA1x = x-Ax1
	rA1y = y-Ay1
	rA1z = z-Az1
	rA12 = rA1x^2 + rA1y^2 + rA1z^2
	G1   = rA1x^i1 * rA1y^j1 * rA1z^k1 * exp(-a1 * rA12)

	rA2x = x-Ax2
	rA2y = y-Ay2
	rA2z = z-Az2
	rA22 = rA2x^2 + rA2y^2 + rA2z^2
	G2   = rA2x^i2 * rA2y^j2 * rA2z^k2 * exp(-a2 * rA22)

	rCx  = x-nx
	rCy  = y-ny
	rCz  = z-nz
	rC   = sqrt(rCx^2 + rCy^2 + rCz^2)

	return G1 * (1.0/rC) * G2
end

const limit = 20.0

for i_ = 1:10
	for j_ = 1:10
		iii   = i_-1
		jjj   = j_-1
		atomm = (359*iii+295*jjj-42*iii*jjj+120*iii*iii-38*iii*jjj*iii) % 9
        atomm = (atomm > 0 ? atomm : -atomm)
        print(atomm, " ")

		function integrand(xv::Array{Float64,1})
			x = xv[1]
			y = xv[2]
			z = xv[3]

			ii   = i_-1
			jj   = j_-1
			atom = (359*ii+295*jj-42*ii*jj+120*ii*ii-38*ii*jj*ii) % 9
            atom = (atom > 0 ? atom : -atom)
            nx   = p[atom+1,5]
            ny   = p[atom+1,6]
            nz   = p[atom+1,7]

			i1  = Int(p[i_,1])
			j1  = Int(p[i_,2])
			k1  = Int(p[i_,3])
			a1  = p[i_,4]
			Ax1 = p[i_,5]
			Ay1 = p[i_,6]
			Az1 = p[i_,7]

			i2  = Int(p[j_,1])
			j2  = Int(p[j_,2])
			k2  = Int(p[j_,3])
			a2  = p[j_,4]
			Ax2 = p[j_,5]
			Ay2 = p[j_,6]
			Az2 = p[j_,7]

			return Gp(	i1,j1,k1,a1,
						Ax1,Ay1,Az1, 
					 	i2,j2,k2,a2, 
					 	Ax2,Ay2,Az2,
					 	x,y,z,
					 	nx,ny,nz)
		end

		(val,err) = hcubature(integrand, 	[-limit -limit -limit], 
											[ limit  limit  limit],
											maxevals=Int(1e8))
        println(i_-1,",",j_-1,"  ",val, "  ", err)
	end
end


###
0 0,0  3.1415926533658096  3.141585633212824e-8
7 0,1  0.006074920001265211  3.497374874325025e-10
5 0,2  -0.23052941394905704  2.30523878514338e-9
3 0,3  0.46132628910991313  4.613156630512831e-9
1 0,4  7.268945588234585e-7  7.268549075306575e-15
8 0,5  0.00025406674202605085  2.5406393857253095e-12
6 0,6  0.027310496584978753  2.7310419313765134e-10
4 0,7  0.00018540471339760636  1.8540334792528444e-12
2 0,8  5.778111260027035e-6  5.777958283125271e-14
0 0,9  -1.815687087152885e-16  1.2770208055574657e-12
2 1,0  -0.013094721102909032  1.7843358673908886e-10
1 1,1  0.4327262607944475  4.327199916475751e-9
0 1,2  0.003027063079561614  5.337292256599485e-10
8 1,3  0.0034420493932179274  3.44202925202207e-11
7 1,4  1.4228902001469234e-11  1.4228515052317442e-19
6 1,5  0.0033093593319287328  3.309313649849306e-11
5 1,6  0.0006314855922591248  6.31477317897022e-12
4 1,7  -0.00022790564566524074  2.43596132550423e-12
3 1,8  0.00026910632363427576  2.691056995540604e-12
2 1,9  -1.0462479014076779e-5  3.3516047192980705e-13
1 2,0  -0.45107283223908223  4.510676635305952e-9
6 2,1  0.010286345925569465  5.24560923874525e-10
2 2,2  5.817764172841145  5.8175930446741814e-8
7 2,3  0.040611815573108855  1.4592362121490794e-9
3 2,4  0.0075311591708828556  7.53108572048714e-11
8 2,5  0.0005194380972370773  5.194335566974205e-12
4 2,6  0.00886824656010711  8.868239425882754e-11
0 2,7  2.1136689241938797e-5  6.8236081612313396e-12
5 2,8  7.924020550401278e-5  2.3111248161876066e-12
1 2,9  0.0002839888511243284  1.6051371142119867e-11
6 3,0  0.48802754645553226  4.880219380034574e-9
4 3,1  0.002648186906494125  2.648168148731489e-11
2 3,2  -0.07678460602474547  5.084905124808289e-9
0 3,3  0.5166079677420846  5.166067096019721e-9
7 3,4  -0.000655241793817792  6.552382438945815e-12
5 3,5  3.986772427808622e-5  3.9866658783306117e-13
3 3,6  0.017774616400338658  1.7774597174632569e-10
1 3,7  0.0003086310430353173  3.086283085546246e-12
8 3,8  5.543591928595568e-7  5.543494246759951e-15
6 3,9  0.00035650065574742966  2.4373698209902607e-11
8 4,0  4.2500164875956653e-7  4.249960095425402e-15
4 4,1  2.4927755071701687e-11  2.4927473553016197e-19
0 4,2  0.004909405643136002  4.9093209394610776e-11
5 4,3  -0.0005023090430357823  5.023044990751051e-12
1 4,4  0.004202353409199214  4.2023458521075305e-11
6 4,5  1.5371142804902347e-24  1.5370721654713688e-32
2 4,6  4.924473721319061e-12  4.9243578931970596e-20
2 4,7  6.905163622350916e-20  6.905149157991065e-28
6 4,8  8.306564061640697e-25  8.306386554807382e-33
1 4,9  7.220991086785289e-14  7.220860905402933e-22
7 5,0  0.000507784484619674  5.0777258905716064e-12
6 5,1  0.0033093593319287315  3.309313647549267e-11
5 5,2  0.0011528104131842013  1.1528085576123848e-11
4 5,3  7.705198457423765e-6  7.704979593771121e-14
3 5,4  2.410108510596155e-24  2.4100842248419e-32
2 5,5  0.004102206391201345  4.102213227117669e-11
8 5,6  2.76413069443805e-7  2.7641095809100677e-15
0 5,7  -1.3948319445262764e-5  1.394803244837436e-13
1 5,8  0.0008258291632648564  8.258170938540642e-12
2 5,9  -4.5298907595249374e-8  4.529895115579471e-16
3 6,0  0.015936503246740223  1.5936269118590193e-10
1 6,1  0.0007350481708358709  9.082455561717385e-12
8 6,2  0.009144848083638963  9.144830591005385e-11
6 6,3  0.032821255643898886  3.282048412282434e-10
4 6,4  1.3542259817836055e-12  1.3542248422800316e-20
7 6,5  1.3363022229319703e-6  1.336290082878302e-14
0 6,6  0.004711749523306242  4.711650757030882e-11
2 6,7  -4.754313500523911e-6  4.186115815073762e-13
4 6,8  3.631841932544608e-9  3.631791867595981e-17
6 6,9  4.697511550207584e-5  5.727774171315872e-12
5 7,0  0.0005969404237721026  5.9693425794234864e-12
7 7,1  -0.001480708187061003  3.402465513522691e-11
0 7,2  2.1136689241938553e-5  6.823608162826399e-12
2 7,3  7.57674947377281e-5  1.029090573048174e-12
4 7,4  1.3633871200861467e-20  1.3633739555170452e-28
3 7,5  -1.1307037875624766e-5  1.1306744426636417e-13
1 7,6  8.970000686420271e-6  8.57666102278819e-13
8 7,7  0.00021574636842238305  2.1574603516177413e-12
6 7,8  -2.234200428100585e-7  2.2341715502728685e-15
4 7,9  1.1561240030255978e-5  1.1561005897287701e-13
4 8,0  3.2917663138891026e-6  3.2916976043212957e-14
6 8,1  0.00039358009688162895  3.935790314495361e-12
8 8,2  -4.763672921374937e-5  6.609730539381745e-13
1 8,3  1.3178492797287207e-6  1.3178251907407654e-14
3 8,4  2.0079402780420135e-24  2.0079222071453534e-32
4 8,5  0.0001413448025906942  2.0733053835795916e-12
2 8,6  7.054654012891686e-9  7.05457195793088e-17
0 8,7  -9.812099341830464e-8  1.5442359085376516e-15
7 8,8  0.01717006262012088  1.717004541079018e-10
5 8,9  1.347896861404398e-10  5.148232473303475e-18
0 9,0  -1.8157269241711854e-16  1.2770208060520789e-12
7 9,1  -6.593276151981825e-5  1.2144922691338602e-12
5 9,2  0.0001913392059082481  1.3729685198767551e-11
3 9,3  0.0005111756784420688  5.530789512564176e-12
1 9,4  7.22099108678529e-14  7.220860906843092e-22
1 9,5  -8.313098534128289e-8  8.313044448888727e-16
3 9,6  1.830157173152344e-5  1.8789076150599854e-12
5 9,7  2.7116215705538686e-5  2.711621640933204e-13
7 9,8  7.017440495943132e-12  3.444097976096082e-17
0 9,9  0.0003482280453863658  3.4822266678728615e-12
###

###
m_exactElectronNucleus(0,0) = 3.141592653396305;  
m_exactElectronNucleus(0,1) = 0.006074920002336657;  
m_exactElectronNucleus(0,2) = -0.23052941394817655;  
m_exactElectronNucleus(0,3) = 0.46132628910842943;  
m_exactElectronNucleus(0,4) = 7.268945590080572e-7;  
m_exactElectronNucleus(0,5) = 0.00019929926619836284;  
m_exactElectronNucleus(0,6) = 0.027310496584566385;  
m_exactElectronNucleus(0,7) = 0.0001854033428543244;  
m_exactElectronNucleus(0,8) = 5.778111260020206e-6;  
m_exactElectronNucleus(0,9) = -1.0484091038441683e-17;  
m_exactElectronNucleus(1,0) = -0.013094721102328675;  
m_exactElectronNucleus(1,1) = 0.43272621892355256;  
m_exactElectronNucleus(1,2) = 0.0030270630807894675;  
m_exactElectronNucleus(1,3) = 0.003442049393588565;  
m_exactElectronNucleus(1,4) = 1.4228902001479771e-11;  
m_exactElectronNucleus(1,5) = 0.003430101670771089;  
m_exactElectronNucleus(1,6) = 0.0006314855924455602;  
m_exactElectronNucleus(1,7) = -0.0001807195948772219;  
m_exactElectronNucleus(1,8) = 0.0002691063236345793;  
m_exactElectronNucleus(1,9) = -1.0462479019948222e-5;  
m_exactElectronNucleus(2,0) = -0.4510728322381398;  
m_exactElectronNucleus(2,1) = 0.010286345926581059;  
m_exactElectronNucleus(2,2) = 5.8177641728586185;  
m_exactElectronNucleus(2,3) = 0.04061181557716256;  
m_exactElectronNucleus(2,4) = 0.007531157186406296;  
m_exactElectronNucleus(2,5) = 0.00042066329652329707;  
m_exactElectronNucleus(2,6) = 0.008868246560207824;  
m_exactElectronNucleus(2,7) = 2.1136695773319227e-5;  
m_exactElectronNucleus(2,8) = 7.92402055095499e-5;  
m_exactElectronNucleus(2,9) = 0.0002839888511347502;  
m_exactElectronNucleus(3,0) = 0.4880275464523432;  
m_exactElectronNucleus(3,1) = 0.00264818690665339;  
m_exactElectronNucleus(3,2) = -0.07678460604402675;  
m_exactElectronNucleus(3,3) = 0.5166079677373133;  
m_exactElectronNucleus(3,4) = -0.0006552403098904724;  
m_exactElectronNucleus(3,5) = 3.9867724278037694e-5;  
m_exactElectronNucleus(3,6) = 0.017774616398394436;  
m_exactElectronNucleus(3,7) = 0.0003086285665016171;  
m_exactElectronNucleus(3,8) = 5.559844717322346e-7;  
m_exactElectronNucleus(3,9) = 0.0003565006556826383;  
m_exactElectronNucleus(4,0) = 4.2500164887987364e-7;  
m_exactElectronNucleus(4,1) = 2.4927755071505254e-11;  
m_exactElectronNucleus(4,2) = 0.0049094042160749895;  
m_exactElectronNucleus(4,3) = -0.000502308838378577;  
m_exactElectronNucleus(4,4) = 0.0034477120078254845;  
m_exactElectronNucleus(4,5) = 1.5371142804860259e-24;  
m_exactElectronNucleus(4,6) = 4.924473721312616e-12;  
m_exactElectronNucleus(4,7) = 6.905163622343064e-20;  
m_exactElectronNucleus(4,8) = 8.30656406158157e-25;  
m_exactElectronNucleus(4,9) = 7.22099108679538e-14;  
m_exactElectronNucleus(5,0) = 0.0003964642966433137;  
m_exactElectronNucleus(5,1) = 0.003430101670771089;  
m_exactElectronNucleus(5,2) = 0.0008455744801229993;  
m_exactElectronNucleus(5,3) = 7.705198457410324e-6;  
m_exactElectronNucleus(5,4) = 2.4101085105907703e-24;  
m_exactElectronNucleus(5,5) = 0.00410220639105157;  
m_exactElectronNucleus(5,6) = 1.2630206441032246e-7;  
m_exactElectronNucleus(5,7) = 5.6014767862038486e-6;  
m_exactElectronNucleus(5,8) = 0.0008258291632664241;  
m_exactElectronNucleus(5,9) = -4.5500202831399375e-8;  
m_exactElectronNucleus(6,0) = 0.015936503246800314;  
m_exactElectronNucleus(6,1) = 0.0007350481705785905;  
m_exactElectronNucleus(6,2) = 0.009144848083587178;  
m_exactElectronNucleus(6,3) = 0.0328212556384292;  
m_exactElectronNucleus(6,4) = 1.3542259817811092e-12;  
m_exactElectronNucleus(6,5) = 7.016619072036424e-7;  
m_exactElectronNucleus(6,6) = 0.004711749527433483;  
m_exactElectronNucleus(6,7) = -4.7548817289418276e-6;  
m_exactElectronNucleus(6,8) = 3.1773271156945297e-9;  
m_exactElectronNucleus(6,9) = 4.6975115505053096e-5;  
m_exactElectronNucleus(7,0) = 0.000596978685186941;  
m_exactElectronNucleus(7,1) = -0.0012490246665673745;  
m_exactElectronNucleus(7,2) = 2.1136695773319055e-5;  
m_exactElectronNucleus(7,3) = 7.57677376794402e-5;  
m_exactElectronNucleus(7,4) = 1.3633871200785802e-20;  
m_exactElectronNucleus(7,5) = -9.637059171293783e-6;  
m_exactElectronNucleus(7,6) = 8.967568581016109e-6;  
m_exactElectronNucleus(7,7) = 0.00020903847764887004;  
m_exactElectronNucleus(7,8) = -2.2328866337784158e-7;  
m_exactElectronNucleus(7,9) = 1.1471361708965405e-5;  
m_exactElectronNucleus(8,0) = 3.2917663138879515e-6;  
m_exactElectronNucleus(8,1) = 0.0003935800968818937;  
m_exactElectronNucleus(8,2) = -4.76367292089517e-5;  
m_exactElectronNucleus(8,3) = 1.3192670999483967e-6;  
m_exactElectronNucleus(8,4) = 2.0079402780434024e-24;  
m_exactElectronNucleus(8,5) = 0.00014134480259141638;  
m_exactElectronNucleus(8,6) = 7.0381882787075285e-9;  
m_exactElectronNucleus(8,7) = -9.807157201988673e-8;  
m_exactElectronNucleus(8,8) = 0.01717006262007232;  
m_exactElectronNucleus(8,9) = 1.3478816243453474e-10;  
m_exactElectronNucleus(9,0) = -1.0494358020360562e-17;  
m_exactElectronNucleus(9,1) = -6.593276157701992e-5;  
m_exactElectronNucleus(9,2) = 0.000191339205906294;  
m_exactElectronNucleus(9,3) = 0.0005111756784408499;  
m_exactElectronNucleus(9,4) = 7.220991086795381e-14;  
m_exactElectronNucleus(9,5) = -8.051653540594755e-8;  
m_exactElectronNucleus(9,6) = 1.8301571728799462e-5;  
m_exactElectronNucleus(9,7) = 2.6909848608678254e-5;  
m_exactElectronNucleus(9,8) = 7.015232036920832e-12;  
m_exactElectronNucleus(9,9) = 0.00034822804501452684;  
###
